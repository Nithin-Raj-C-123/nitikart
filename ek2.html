<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1">
Â  <title>Nithinkart E-Commerce Row-Wise Layout</title>
Â  <style>
Â  Â  :root {
Â  Â  Â  --nav-height: 16vh;
Â  Â  Â  --category-height: 12vh;
Â  Â  Â  --subcategory-height: 5vh;
Â  Â  Â  --items-height: 67vh;
Â  Â  Â  --primary: #2abf2a; /* Slightly brighter green */
Â  Â  Â  --secondary: #0056d2; /* Slightly darker blue */
Â  Â  Â  --accent: #d22b31; /* More vivid red */
Â  Â  Â  --bg: #f3faf4;
Â  Â  Â  --text: #222;
Â  Â  Â  --card: #fff;
Â  Â  Â  --shadow: 0 2px 20px rgba(0,0,0,0.1);
Â  Â  }
Â  Â  [data-theme="dark"] {
Â  Â  Â  --primary: #25d555;
Â  Â  Â  --secondary: #336afc;
Â  Â  Â  --accent: #ff4949;
Â  Â  Â  --bg: #181d23;
Â  Â  Â  --text: #e0e0e0;
Â  Â  Â  --card: #1c232a;
Â  Â  Â  --shadow: 0 2px 26px #0a0a0a;
Â  Â  }
Â  Â  html,body {
Â  Â  Â  height: 100%;
Â  Â  Â  min-height: 100%;
Â  Â  Â  background: var(--bg);
Â  Â  Â  color: var(--text);
Â  Â  Â  font-family: 'Segoe UI', Arial, sans-serif;
Â  Â  Â  margin: 0;
Â  Â  Â  transition: background 0.3s, color 0.3s;
Â  Â  }
Â  Â  #login-page {
Â  Â  Â  min-height: 100vh;
Â  Â  Â  display: flex;
Â  Â  Â  align-items: center;
Â  Â  Â  justify-content: center;
Â  Â  Â  background: linear-gradient(135deg, #2df546 0%, #007bff 100%);
Â  Â  Â  animation: bgmove 8s linear infinite alternate;
Â  Â  }
Â  Â  @keyframes bgmove {
Â  Â  Â  0% { background-position: 0 50%; }
Â  Â  Â  100% { background-position: 100% 50%; }
Â  Â  }
Â  Â  #login-form {
Â  Â  Â  background: var(--card);
Â  Â  Â  box-shadow: var(--shadow);
Â  Â  Â  border-radius: 18px;
Â  Â  Â  padding: 2.4rem 2.2rem;
Â  Â  Â  width: 380px;
Â  Â  Â  display: flex;
Â  Â  Â  flex-direction: column;
Â  Â  Â  gap: 1.2rem;
Â  Â  Â  animation: popIn 0.8s ease forwards;
Â  Â  }
Â  Â  @keyframes popIn { from{opacity:0; transform:scale(0.93);} to{opacity:1; transform:scale(1);} }
Â  Â  #login-form h2 { color: var(--primary); text-align:center; }
Â  Â  label { font-weight: 500; color: var(--secondary);}
Â  Â  input, select {
Â  Â  Â  border-radius:9px;
Â  Â  Â  border: 2px solid #dfe6f0;
Â  Â  Â  background: var(--bg);
Â  Â  Â  font-size:1em; padding: 0.5em 0.7em;
Â  Â  Â  margin-top:0.08em;
Â  Â  Â  margin-bottom:0.3em;
Â  Â  Â  transition: border .2s;
Â  Â  }
Â  Â  input:focus { outline: none; border-color: var(--primary); }
Â  Â  .animated-btn {
Â  Â  Â  background: linear-gradient(95deg,var(--primary),var(--secondary));
Â  Â  Â  color: #fff;
Â  Â  Â  font-weight: bold;
Â  Â  Â  border: none;
Â  Â  Â  transition: background 0.2s, box-shadow 0.2s;
Â  Â  Â  border-radius: 9px;
Â  Â  Â  font-size: 1em;
Â  Â  Â  height:2.7em;
Â  Â  Â  cursor: pointer;
Â  Â  Â  margin-top: 0.6em;
Â  Â  Â  box-shadow:0 2px 7px rgba(55,200,70,0.12);
Â  Â  Â  letter-spacing: 1px;
Â  Â  }
Â  Â  .animated-btn:hover { background: linear-gradient(100deg, #12c45e, #3383f4);}
Â  Â  
Â  Â  /* Main App Structure Row Wise */
Â  Â  #app {
Â  Â  Â  min-height: 100vh;
Â  Â  Â  display: flex;
Â  Â  Â  flex-direction: column;
Â  Â  Â  width: 100vw;
Â  Â  Â  overflow: hidden;
Â  Â  }
Â  Â  /* NavPanel */
Â  Â  #nav-panel {
Â  Â  Â  display: flex; align-items: center;
Â  Â  Â  height: var(--nav-height);
Â  Â  Â  background: var(--card);
Â  Â  Â  box-shadow: var(--shadow);
Â  Â  Â  border-bottom: 2px solid #a2e3b3;
Â  Â  Â  z-index: 13;
Â  Â  Â  padding: 0 14px;
Â  Â  Â  gap: 21px;
Â  Â  }
Â  Â  #app-title {
Â  Â  Â  font-weight: 700;
Â  Â  Â  font-size: 1.8em;
Â  Â  Â  color: var(--primary);
Â  Â  Â  margin-right: auto;
Â  Â  Â  user-select: none;
Â  Â  }
Â  Â  #nav-buttons {
Â  Â  Â  display: flex;
Â  Â  Â  gap: 16px;
Â  Â  Â  height: 78%;
Â  Â  }
Â  Â  .nav-btn {
Â  Â  Â  background: linear-gradient(95deg,var(--primary),var(--secondary));
Â  Â  Â  color: #fff;
Â  Â  Â  padding: 0.75em 2em;
Â  Â  Â  font-weight: 600;
Â  Â  Â  border-radius: 10px;
Â  Â  Â  border: none;
Â  Â  Â  font-size: 1.18em;
Â  Â  Â  cursor: pointer;
Â  Â  Â  box-shadow: 0 3px 13px rgba(0,190,140,0.18);
Â  Â  Â  transition: background 0.22s, box-shadow 0.21s, transform .10s;
Â  Â  Â  outline:none;
Â  Â  Â  position:relative;
Â  Â  Â  overflow:hidden;
Â  Â  }
Â  Â  .nav-btn.active, .nav-btn:focus, .nav-btn:hover {
Â  Â  Â  background: linear-gradient(100deg,#08662d,#0951c1);
Â  Â  Â  box-shadow: 0 5px 20px #22c46839;
Â  Â  Â  transform: scale(1.07);
Â  Â  }
Â  Â  
Â  Â  #search-container {
Â  Â  Â  margin-left:20px;
Â  Â  Â  position: relative;
Â  Â  Â  flex: 1;
Â  Â  Â  max-width: 380px;
Â  Â  Â  height: 80%;
Â  Â  Â  display: flex;
Â  Â  Â  align-items: center;
Â  Â  }
Â  Â  #search-input {
Â  Â  Â  width: 100%;
Â  Â  Â  padding: 0.7em 2em 0.7em 1em;
Â  Â  Â  border-radius: 9px;
Â  Â  Â  border: 2px solid #aee9c9;
Â  Â  Â  background: #f2fffd;
Â  Â  Â  font-size: 1em;
Â  Â  Â  transition: border-color 0.18s;
Â  Â  }
Â  Â  #clear-search-history {
Â  Â  Â  position: absolute; right: 10px; font-size:1.3em; color:var(--accent); border:none; background:none; cursor:pointer;
Â  Â  Â  top: 50%; transform: translateY(-50%);
Â  Â  }
Â  Â  #search-history-list {
Â  Â  Â  position: absolute;
Â  Â  Â  left: 0; top:110%; 
Â  Â  Â  background: var(--card); color:var(--secondary); width: 100%;
Â  Â  Â  border: 1px solid #dde1eb; border-radius:7px;
Â  Â  Â  box-shadow: var(--shadow);
Â  Â  Â  z-index: 100;
Â  Â  Â  display: none;
Â  Â  }


Â  Â  /* Modal Overlay */
Â  Â  .modal-overlay {
Â  Â  Â  display:none; position:fixed; left:0;top:0;width:100vw;height:100vh;z-index:99;
Â  Â  Â  background:rgba(2,60,24,0.28); align-items:center; justify-content:center;
Â  Â  }
Â  Â  .modal-content {
Â  Â  Â  background:var(--card); padding:2.5rem 2.1rem 1.9rem 2.1rem;
Â  Â  Â  border-radius:18px; box-shadow:var(--shadow); min-width:320px; max-width:97vw;
Â  Â  Â  max-height:85vh;overflow:auto; position:relative;
Â  Â  }
Â  Â  .modal-header {
Â  Â  Â  font-weight:bold; color:var(--primary); font-size:1.4em; margin-bottom:10px;
Â  Â  Â  text-align:center;
Â  Â  }
Â  Â  .close-modal-btn {
Â  Â  Â  position:absolute;right:0.5em;top:0.5em;background:transparent;border:none;color:var(--accent);font-size:1.7em;cursor:pointer;
Â  Â  }
Â  Â  
Â  Â  /* Category bar */
Â  Â  #category-panel {
Â  Â  Â  display: flex;
Â  Â  Â  flex-direction: row;
Â  Â  Â  align-items: center;
Â  Â  Â  height: var(--category-height);
Â  Â  Â  background: var(--bg);
Â  Â  Â  border-bottom: 2px solid #bee4ca;
Â  Â  Â  padding: 0 12px;
Â  Â  Â  overflow-x: auto;
Â  Â  Â  gap: 19px;
Â  Â  Â  z-index: 7;
Â  Â  }
Â  Â  .category-btn {
Â  Â  Â  background: linear-gradient(95deg, var(--primary),var(--secondary));
Â  Â  Â  color: #fff; border: none;
Â  Â  Â  border-radius: 13px; font-size: 1.08em; font-weight: 600; padding: 0.7em 1.7em;
Â  Â  Â  cursor: pointer; margin-right: 0;
Â  Â  Â  white-space:nowrap; transition: background 0.2s, box-shadow 0.12s;
Â  Â  Â  box-shadow: 0 2px 8px #1ad68a1c;
Â  Â  Â  outline:none;
Â  Â  }
Â  Â  .category-btn.active, .category-btn:focus, .category-btn:hover { background: linear-gradient(100deg,#12c45e,#3383f4);box-shadow:0 3px 15px #15c68fd1;}
Â  Â  
Â  Â  /* Subcategory Bar */
Â  Â  #subcategory-panel {
Â  Â  Â  display: flex; align-items: center;
Â  Â  Â  height: var(--subcategory-height);
Â  Â  Â  background: var(--card);
Â  Â  Â  border-bottom: 1px solid #b8f6c7;
Â  Â  Â  padding: 0 14px;
Â  Â  Â  overflow-x: auto;
Â  Â  Â  gap: 13px;
Â  Â  Â  z-index: 6;
Â  Â  }
Â  Â  .subcategory-btn {
Â  Â  Â  background: linear-gradient(100deg,#23b123,#007bff);
Â  Â  Â  color: #fff; border: none;
Â  Â  Â  border-radius: 9px; font-size:1em; font-weight:600;
Â  Â  Â  padding: 0.52em 1.8em;
Â  Â  Â  cursor: pointer; margin-right: 0;
Â  Â  Â  transition: background 0.24s, box-shadow 0.13s;
Â  Â  Â  box-shadow: 0 1px 7px #90f7c93b;
Â  Â  Â  outline:none;
Â  Â  }
Â  Â  .subcategory-btn.active, .subcategory-btn:hover { background: linear-gradient(90deg,#0a6313,#3383f4);}
Â  Â  /* Items */
Â  Â  #items-panel {
Â  Â  Â  background: var(--bg);
Â  Â  Â  flex: 1 1 var(--items-height);
Â  Â  Â  min-height: var(--items-height);
Â  Â  Â  padding: 18px 16px 16px 16px;
Â  Â  Â  display: flex; flex-direction: column;
Â  Â  Â  overflow-y: auto;
Â  Â  }
Â  Â  #filters-bar {
Â  Â  Â  display: flex; gap: 21px;
Â  Â  Â  align-items: center; margin-bottom: 15px; flex-wrap: wrap;
Â  Â  Â  background: #ffffffbe;
Â  Â  Â  padding:7px 13px;border-radius:9px;
Â  Â  }
Â  Â  #price-range {display: flex; align-items: center;}
Â  Â  #price-value {font-weight: 600; margin-left: 10px;}
Â  Â  #rating-filter button {
Â  Â  Â  background: var(--secondary); color: #fff;
Â  Â  Â  border: none; padding: 6px 14px; border-radius: 8px;
Â  Â  Â  cursor: pointer; font-weight: 600; font-size: 1em;
Â  Â  Â  margin-right:3px; transition: background 0.17s;
Â  Â  Â  outline: none;
Â  Â  }
Â  Â  #rating-filter button.active { background: var(--primary);}
Â  Â  #rating-filter button:hover:not(.active) { background: #23b123;}
Â  Â  #items-list {
Â  Â  Â  display: flex; flex-wrap: wrap; gap: 22px; justify-content:flex-start;
Â  Â  }
Â  Â  .item-card {
Â  Â  Â  width: 255px; background: var(--card); border-radius: 14px;
Â  Â  Â  box-shadow: var(--shadow);
Â  Â  Â  padding: 0 0 11px 0; display: flex; flex-direction: column;
Â  Â  Â  transition: transform 0.23s, box-shadow 0.13s;
Â  Â  Â  margin-bottom:12px;
Â  Â  Â  border: 2px solid #d9f3e1;
Â  Â  Â  position:relative;
Â  Â  }
Â  Â  .item-card:hover { transform:scale(1.045); border-color:#23b12380; box-shadow:0 7px 21px #09864125;}
Â  Â  .item-image { width:100%; height:154px; object-fit:cover; border-radius: 14px 14px 0 0; background:#f0faff;}
Â  Â  .item-details {padding: 12px 15px 0 15px; flex:1 1 auto;}
Â  Â  .item-name {font-size: 1.13rem; font-weight:700; margin-bottom: 4px;}
Â  Â  .item-description {font-size: 0.97rem; margin-bottom:9px; color:var(--secondary);}
Â  Â  .item-price {font-size:1.25rem; font-weight:700; color:var(--primary); margin-bottom:7px;}
Â  Â  .item-rating, .stars {color:gold;}
Â  Â  .item-action {text-align:center; margin-top:8px;}
Â  Â  .add-cart-btn {
Â  Â  Â  background:var(--primary); color:#fff; border:none;
Â  Â  Â  padding:9px 0; border-radius:10px; font-weight:600;
Â  Â  Â  width:93%; font-size:1.04em;
Â  Â  Â  cursor:pointer; margin: auto; transition: background 0.22s, box-shadow 0.1s;
Â  Â  Â  margin-top:5px;
Â  Â  }
Â  Â  .add-cart-btn.added {background:var(--accent);}
Â  Â  .add-cart-btn:disabled {opacity:0.7; cursor:not-allowed;}
Â  Â  /* Cart Table style */
Â  Â  .cart-table {
Â  Â  Â  width: 100%; border-collapse: collapse; margin-bottom: 1em; font-size:1.05em;
Â  Â  }
Â  Â  .cart-table th, .cart-table td { padding:11px 8px; border-bottom:1px solid #dcedf3; text-align:center;}
Â  Â  .cart-table th { color:var(--primary); background:#f1fcf2;}
Â  Â  .cart-table td {vertical-align:middle;}
Â  Â  .cart-incbtn,.cart-decbtn {
Â  Â  Â  background:linear-gradient(90deg,var(--secondary),var(--primary));border:none;color:#fff;font-weight:bold;
Â  Â  Â  font-size:1.12em;padding:2px 12px;border-radius:7px;cursor:pointer;transition:background 0.14s;
Â  Â  }
Â  Â  .cart-incbtn:hover,.cart-decbtn:hover {background:linear-gradient(90deg,var(--primary),var(--secondary));}
Â  Â  .cart-removebtn {color:var(--accent);border:none;background:none;font-size:1.2em;cursor:pointer;}
Â  Â  .confirm-order-btn,.clear-cart-btn {
Â  Â  Â  background:linear-gradient(90deg,var(--primary),var(--secondary)); color:#fff; border:none;
Â  Â  Â  margin-right:14px;
Â  Â  Â  border-radius:9px;font-size:1em;font-weight:700; padding: .6em 2.4em; cursor:pointer; transition:background 0.2s;
Â  Â  Â  box-shadow:0 2px 8px #14b34317;margin-top:12px;
Â  Â  }
Â  Â  .clear-cart-btn {background:linear-gradient(100deg,var(--accent),#fff);}
Â  Â  .confirm-order-btn:hover {background:linear-gradient(100deg,#09953d,#1e6cd7);}
Â  Â  .clear-cart-btn:hover {background:linear-gradient(90deg,#c22129,#fee3eb);}
Â  Â  /* Profile Modal */
Â  Â  .profile-detail-box label {font-weight:600; color:var(--primary);}
Â  Â  .order-list {margin:0; padding:0; list-style:decimal; }
Â  Â  .order-list li {
Â  Â  Â  margin:0.2em 0 0.9em 1em; color:var(--secondary); 
Â  Â  Â  border-bottom:1px solid #d1e7d1; padding-bottom:4px;}
Â  Â  .reset-btn {
Â  Â  Â  background:linear-gradient(95deg,var(--primary),var(--secondary));
Â  Â  Â  color:#fff; border:none; border-radius:8px; padding:0.5em 1.4em;cursor:pointer;
Â  Â  Â  margin-top:13px; font-weight:bold;
Â  Â  Â  transition:background .18s;
Â  Â  }
Â  Â  .reset-btn:hover {background:linear-gradient(90deg,#066941,#3383f4);}
Â  Â  /* Responsive */
Â  Â  @media(max-width:890px) {
Â  Â  Â  .item-card { width: 95vw;}
Â  Â  Â  #items-list { flex-direction: column; flex-wrap:nowrap;}
Â  Â  Â  #filters-bar { align-items:flex-start;}
Â  Â  Â  #category-panel { flex-wrap:wrap;}
Â  Â  Â  #subcategory-panel { flex-wrap:wrap;}
Â  Â  Â  #nav-panel {flex-direction: column; height:auto;gap:7px;}
Â  Â  Â  #nav-buttons {gap:8px;flex-wrap:wrap;}
Â  Â  }

Â  Â  /* Edit Profile Button */
Â  Â  .edit-profile-btn {
Â  Â  Â  background: linear-gradient(95deg,var(--primary),var(--secondary));
Â  Â  Â  color: #fff;
Â  Â  Â  font-weight: 600;
Â  Â  Â  border-radius: 9px;
Â  Â  Â  border: none;
Â  Â  Â  padding: 0.48em 1.3em;
Â  Â  Â  cursor: pointer;
Â  Â  Â  box-shadow: 0 2px 8px #1ad68a1c;
Â  Â  Â  transition: background 0.22s;
Â  Â  Â  margin-top: 0.9em;
Â  Â  }
Â  Â  .edit-profile-btn:hover {
Â  Â  Â  background: linear-gradient(100deg,#12c45e,#3383f4);
Â  Â  }
Â  Â  /* Edit Profile Form */
Â  Â  #edit-profile-form label {
Â  Â  Â  font-weight: 600;
Â  Â  Â  color: var(--primary);
Â  Â  Â  display: block;
Â  Â  Â  margin-top: 12px;
Â  Â  }
Â  Â  #edit-profile-form input {
Â  Â  Â  width: 95%;
Â  Â  Â  margin-top: 5px;
Â  Â  }
Â  Â  #edit-profile-form button {
Â  Â  Â  margin-top: 15px;
Â  Â  }
Â  </style>
</head>
<body>
<!-- LOGIN PAGE -->
<div id="login-page">
Â  <form id="login-form" autocomplete="off">
Â  Â  <h2>Welcome to Nithinkart</h2>
Â  Â  <label>Full Name</label>
Â  Â  <input id="fullname" type="text" required placeholder="Full Name (min 2 words)">
Â  Â  <label>Phone</label>
Â  Â  <input id="phone" type="text" maxlength="10" pattern="^\d{10}$" required placeholder="10 digit number" />
Â  Â  <label>Email</label>
Â  Â  <input id="email" type="email" required placeholder="your@email.com">
Â  Â  <label>Password</label>
Â  Â  <input id="password" type="password" required minlength="6" placeholder="Min 6 chars">
Â  Â  <label>Location</label>
Â  Â  <input id="location-input" type="text" placeholder="Search or use current location"><br>
Â  Â  <button type="button" id="use-current-location" class="animated-btn" style="background:linear-gradient(95deg,#13c312, #007bff);margin-bottom:2px;">Use Current Location</button>
Â  Â  <button type="button" id="clear-location" class="animated-btn" style="background:linear-gradient(95deg,#ef5350, #23b123);margin-bottom:7px;">Clear</button>
Â  Â  <button type="submit" class="animated-btn">Login</button>
Â  Â  <div id="login-error" style="color: var(--accent); text-align: center; height:1.3em"></div>
Â  </form>
</div>
<!-- Modal System -->
<div id="modal-overlay" class="modal-overlay">
Â  <div class="modal-content" id="modal-content">
Â  Â  <!-- Modal content loaded dynamically -->
Â  </div>
</div>
<!-- MAIN APP -->
<div id="app" style="display:none;">
Â  <!-- ROW 1: Navigation -->
Â  <div id="nav-panel">
Â  Â  <div id="app-title">nithinKart</div>
Â  Â  <div id="nav-buttons">
Â  Â  Â  <button class="nav-btn active" id="home-btn">Home</button>
Â  Â  Â  <button class="nav-btn" id="category-btn">Category</button>
Â  Â  Â  <button class="nav-btn" id="cart-btn">Cart</button>
Â  Â  Â  <button class="nav-btn" id="profile-btn">Profile</button>
Â  Â  Â  <button class="nav-btn" id="toggle-theme-btn">Toggle Mode</button>
Â  Â  </div>
Â  Â  <div id="search-container">
Â  Â  Â  <input type="text" id="search-input" placeholder="Search items..."/>
Â  Â  Â  <button id="clear-search-history" title="Clear Search History">âŒ</button>
Â  Â  Â  <div id="search-history-list"></div>
Â  Â  </div>
Â  </div>
Â  <!-- ROW 2: Categories -->
Â  <div id="category-panel"></div>
Â  <!-- ROW 3: Subcategories -->
Â  <div id="subcategory-panel"></div>
Â  <!-- ROW 4: Main content (products) -->
Â  <div id="items-panel">
Â  Â  <div id="filters-bar">
Â  Â  Â  <span style="color:var(--primary);font-weight:bold;">Price Range:</span>
Â  Â  Â  <input type="range" id="price-range" min="10" max="200000" step="10" value="200000"/>
Â  Â  Â  <span id="price-value">â‚¹200,000</span>
Â  Â  Â  <span style="color:var(--secondary);font-weight:600;">Filter by rating:</span>
Â  Â  Â  <span id="rating-filter">
Â  Â  Â  Â  <button data-rating="1">1â­</button>
Â  Â  Â  Â  <button data-rating="2">2â­</button>
Â  Â  Â  Â  <button data-rating="3">3â­</button>
Â  Â  Â  Â  <button data-rating="4">4â­</button>
Â  Â  Â  Â  <button data-rating="5">5â­</button>
Â  Â  Â  </span>
Â  Â  </div>
Â  Â  <div id="items-list"></div>
Â  </div>
</div>
<script>
(function(){
//----------------------- DATA -----------------
const categories=[
Â  {name:'All',subs:[]},
Â  {name:'Mobile',subs:['iPhone','Samsung','Oppo','Vivo','Others']},
Â  {name:'Cloth',subs:['Men','Women','Kids']},
Â  {name:'Furniture',subs:['Chair','Wallrobe','Bed']},
Â  {name:'Electronic Gadgets',subs:['Laptop','Hair Drier','Others']},
Â  {name:'Groceries',subs:['Grains','Dhal','Rice','Vegetable','Nonveg']},
Â  {name:'Fashion & Beauty',subs:['Lipstick','Powder','Others']},
Â  {name:'Kitchen',subs:['Box','Knifes','Cooker','Owen']},
Â  {name:'Books',subs:['Poets','Drama','Thriller']},
Â  {name:'Toys',subs:['1 Year','2 Year','4 Year','5+ Years']}
];


// At least 5 items for each subcategory, demo images used
function item(name,desc,category,subcat,price,rating,img){
Â  return {id:`${category}_${subcat}_${name}`.replace(/[\s]/g,''),name,description:desc,category,subcategory:subcat,price,rating,
Â  Â  imageUrl:img};
}
const items=[];
(function generateDemoItems(){
Â  // Mobile
Â  let imgbase='https://via.placeholder.com/300x154.png?text=';
Â  items.push(
Â  Â  item('iPhone 14','Latest Apple iPhone 14','Mobile','iPhone',99999,5,imgbase+'iPhone+14'),
Â  Â  item('iPhone 13','Apple iPhone 13 with A15 chip','Mobile','iPhone',79999,4,imgbase+'iPhone+13'),
Â  Â  item('iPhone SE','Compact Apple iPhone SE','Mobile','iPhone',39999,4,imgbase+'iPhone+SE'),
Â  Â  item('iPhone 12','Apple iPhone 12, 128GB','Mobile','iPhone',59999,4,imgbase+'iPhone+12'),
Â  Â  item('iPhone 11','Apple iPhone 11, 64GB','Mobile','iPhone',43999,3,imgbase+'iPhone+11'),
Â  Â  // Samsung
Â  Â  item('Galaxy S22','Samsung Galaxy S22 Ultra','Mobile','Samsung',85999,5,imgbase+"Galaxy+S22"),
Â  Â  item('Galaxy S21','Samsung Galaxy S21 FE','Mobile','Samsung',67999,4,imgbase+"Galaxy+S21"),
Â  Â  item('Galaxy A53','Midrange Super AMOLED','Mobile','Samsung',33999,4,imgbase+"Galaxy+A53"),
Â  Â  item('Galaxy F14','Affordable 5G Model','Mobile','Samsung',15499,3,imgbase+"Galaxy+F14"),
Â  Â  item('Galaxy M32','Long Battery Life','Mobile','Samsung',16999,4,imgbase+"Galaxy+M32"),
Â  Â  // Oppo
Â  Â  item('Oppo F21 Pro','Flagship Selfie Camera','Mobile','Oppo',23999,4,imgbase+'Oppo+F21'),
Â  Â  item('Oppo A78','Dual Camera Smartphone','Mobile','Oppo',17499,3,imgbase+'Oppo+A78'),
Â  Â  item('Oppo Reno 8','Pro Grade Design','Mobile','Oppo',29999,5,imgbase+'Oppo+Reno8'),
Â  Â  item('Oppo K10','Budget Winner','Mobile','Oppo',15999,4,imgbase+'Oppo+K10'),
Â  Â  item('Oppo A16','Beginner Android','Mobile','Oppo',10499,3,imgbase+'Oppo+A16'),
Â  Â  // Vivo
Â  Â  item('Vivo X90','High-Speed Gaming','Mobile','Vivo',48999,4,imgbase+'Vivo+X90'),
Â  Â  item('Vivo Y18','Vivid Display Quality','Mobile','Vivo',13299,3,imgbase+'Vivo+Y18'),
Â  Â  item('Vivo V27','Ultra Stylish','Mobile','Vivo',23999,5,imgbase+'Vivo+V27'),
Â  Â  item('Vivo T2','All Day Battery','Mobile','Vivo',14299,4,imgbase+'Vivo+T2'),
Â  Â  item('Vivo Y16','Affordable Pick','Mobile','Vivo',9999,3,imgbase+'Vivo+Y16'),
Â  Â  // Others mobiles
Â  Â  item('Realme 10','Great Value Android','Mobile','Others',13499,4,imgbase+'Realme+10'),
Â  Â  item('Nothing Phone 1','Transparent Design','Mobile','Others',29999,4,imgbase+'Nothing+1'),
Â  Â  item('Nokia 110','Ultra Budget Model','Mobile','Others',1599,2,imgbase+'Nokia+110'),
Â  Â  item('Redmi Note 12','Best Seller','Mobile','Others',16199,5,imgbase+'Redmi+12'),
Â  Â  item('Motorola G84','Flagship Killer','Mobile','Others',18499,4,imgbase+'Moto+G84'),
Â  );
Â  // Cloth
Â  let clothImgs=['Men','Women','Kids'].map(e=>imgbase+e+'+Clothing');
Â  for(let i=1;i<=5;i++){
Â  Â  items.push(item('Men Shirt '+i,'Cotton formal shirt black','Cloth','Men',i*800+500,(i%5)+1,clothImgs[0]));
Â  Â  items.push(item('Women Dress '+i,'Trendy summer floral dress','Cloth','Women',i*950+500,5-(i%3),clothImgs[1]));
Â  Â  items.push(item('Kids Wear '+i,'Colorful kids T-shirt','Cloth','Kids',i*399+379,3+(i%3),clothImgs[2]));
Â  }
Â  // Furniture
Â  ['Chair','Wallrobe','Bed'].forEach((sub,k)=>{
Â  Â  let fn=item, c='Furniture', s=sub, img=imgbase+sub; for(let i=1;i<=5;i++) 
Â  Â  Â  items.push(fn(s+' '+i,'Strong wooden '+s.toLowerCase(),'Furniture',s,2999+i*800,3+(i%3),img));
Â  });
Â  // Electronic Gadgets
Â  ['Laptop','Hair Drier','Others'].forEach((sub,k)=>{
Â  Â  let fn=item,c='Electronic Gadgets',s=sub,img=imgbase+sub; for(let i=1;i<=5;i++)
Â  Â  Â  items.push(fn(s+' '+i,'Branded '+s,'Electronic Gadgets',s,11000+i*990,2+(i%4),img));
Â  });
Â  // Groceries
Â  ['Grains','Dhal','Rice','Vegetable','Nonveg'].forEach((sub,k)=>{
Â  Â  let fn=item, c='Groceries',s=sub,img=imgbase+sub;for(let i=1;i<=5;i++)
Â  Â  Â  items.push(fn(s+' Bag '+i,'Organic '+s+' 1kg','Groceries',s,99+i*9,3+(i%3),img));
Â  });
Â  // Fashion & Beauty
Â  ['Lipstick','Powder','Others'].forEach((sub,k)=>{
Â  Â  let any=item,c='Fashion & Beauty',s=sub,img=imgbase+sub;
Â  Â  for(let i=1;i<=5;i++)items.push(any(s+' '+i,'Cosmetic '+s,'Fashion & Beauty',s,199+i*23,2+(i%4),img));
Â  });
Â  // Kitchen
Â  ['Box','Knifes','Cooker','Owen'].forEach((s,k)=>{
Â  Â  let fn=item,c='Kitchen',img=imgbase+s;for(let i=1;i<=5;i++)
Â  Â  Â  items.push(fn(s+' '+i,'Quality Kitchen '+s,'Kitchen',s,259+i*30,3+(i%3),img));
Â  });
Â  // Books
Â  ['Poets','Drama','Thriller'].forEach((s,k)=>{
Â  Â  let fn=item,c='Books',img=imgbase+'Book';for(let i=1;i<=5;i++)
Â  Â  Â  items.push(fn(s+' Book '+i,'Popular '+s+' collection','Books',s,199+i*31,2+(i%4),img));
Â  });
Â  // Toys
Â  let ageList=['1 Year','2 Year','4 Year','5+ Years'];
Â  ageList.forEach((s,k)=>{
Â  Â  let fn=item,c='Toys',img=imgbase+'Toys';for(let i=1;i<=5;i++)
Â  Â  Â  items.push(fn('Toy '+i+' '+s,'Learning Toy for '+s+' olds','Toys',s,120+i*39,3+(i%3),img));
Â  });
})();


// ---- STATE
let loggedInUser=null; let searchHistory=[]; let currentSearchTerm="";
let currentCategory='All',currentSubcategory='',cart=[],orderHistory=[]; 
let maxPriceFilter=200000,ratingFilters=new Set();
const themeKey='nithinkart_theme';


// ----- DOM refs
const loginPage=document.getElementById('login-page'),
Â  app=document.getElementById('app'),loginForm=document.getElementById('login-form'),
Â  fullnameInput=document.getElementById('fullname'),phoneInput=document.getElementById('phone'),
Â  emailInput=document.getElementById('email'),passwordInput=document.getElementById('password'),
Â  locationInput=document.getElementById('location-input'),useCurrentLocationBtn=document.getElementById('use-current-location'),
Â  clearLocationBtn=document.getElementById('clear-location'),loginError=document.getElementById('login-error'),
Â  navButtons=document.querySelectorAll('.nav-btn'),searchInput=document.getElementById('search-input'),
Â  clearSearchHistoryBtn=document.getElementById('clear-search-history'),searchHistoryList=document.getElementById('search-history-list'),
Â  categoryPanel=document.getElementById('category-panel'),subcategoryPanel=document.getElementById('subcategory-panel'),
Â  itemsPanel=document.getElementById('items-panel'),itemsList=document.getElementById('items-list'),
Â  priceRangeInput=document.getElementById('price-range'),priceValueDisplay=document.getElementById('price-value'),
Â  ratingFilterButtons=document.querySelectorAll('#rating-filter button'),
Â  modalOverlay=document.getElementById('modal-overlay'),modalContent=document.getElementById('modal-content');


// -------------- UTIL -------------- //
function showAppSection(section){
Â  // Visible section management for row-wise
Â  itemsPanel.style.display=(section==="home")?'block':'none';
Â  categoryPanel.style.display=(section!=="cart"&&section!=="profile")?'flex':'none';
Â  subcategoryPanel.style.display=(section!=="cart"&&section!=="profile")?'flex':'none';
}
function openModal(html,headerHtml=null){
Â  modalContent.innerHTML=
Â  Â  `<button class="close-modal-btn" onclick="document.getElementById('modal-overlay').style.display='none'">&times;</button>` +
Â  Â  (headerHtml ? `<div class="modal-header">${headerHtml}</div>` : '') +
Â  Â  html;
Â  modalOverlay.style.display='flex';
}
function closeModal(){modalOverlay.style.display='none';}
window.closeModal=closeModal;


// Theme
function applyTheme(){
Â  const saved=localStorage.getItem(themeKey);
Â  document.documentElement.setAttribute('data-theme',saved||'light');
}
applyTheme();


// --------- LOGIN ---------
function validateLoginForm(){
Â  let ok=true;
Â  if(fullnameInput.value.trim().split(/\s+/).length<2){ok=false;}
Â  if(!/^\d{10}$/.test(phoneInput.value.trim())){ok=false;}
Â  if(!/^[\w.-]+@[\w.-]+\.[a-zA-Z]{2,}$/.test(emailInput.value.trim())){ok=false;}
Â  if(passwordInput.value.length<6){ok=false;}
Â  loginError.textContent=ok?'':'Fill all fields correctly';
Â  return ok;
}
loginForm.addEventListener('submit',e=>{
Â  e.preventDefault();
Â  if(!validateLoginForm()) return;
Â  loggedInUser={
Â  Â  fullname:fullnameInput.value.trim(),
Â  Â  phone:phoneInput.value.trim(),
Â  Â  email:emailInput.value.trim(),
Â  Â  password:passwordInput.value,
Â  Â  location:locationInput.value.trim()||'Not set',
Â  Â  loginTime:(new Date()).toLocaleString('en-IN')
Â  };
Â  app.style.display='flex';loginPage.style.display='none';
Â  showAppSection('home');
Â  navButtonActivate('home-btn');
Â  renderCategories();renderSubcategories();renderItems();applyTheme();
});
useCurrentLocationBtn.onclick=()=>{
Â  if(navigator.geolocation){
Â  Â  useCurrentLocationBtn.textContent='Locating...';
Â  Â  navigator.geolocation.getCurrentPosition(function(p){
Â  Â  Â  locationInput.value="Lat:"+p.coords.latitude.toFixed(4)+", Lon:"+p.coords.longitude.toFixed(4);
Â  Â  Â  useCurrentLocationBtn.textContent='Use Current Location';
Â  Â  },()=>{locationInput.value='Unable to get location';useCurrentLocationBtn.textContent='Use Current Location';});
Â  }
};
clearLocationBtn.onclick=()=>locationInput.value='';


// ---------- NAVIGATION (function for each) ----------
function navButtonActivate(id){
Â  navButtons.forEach(b=>b.classList.remove('active'));
Â  document.getElementById(id).classList.add('active');
}
document.getElementById('home-btn').onclick=()=>{
Â  navButtonActivate('home-btn');
Â  currentCategory='All';currentSubcategory='';
Â  showAppSection('home');
Â  renderCategories();renderSubcategories();renderItems();
};
document.getElementById('category-btn').onclick=()=>{
Â  navButtonActivate('category-btn');
Â  currentCategory='All';currentSubcategory='';
Â  showAppSection('home');
Â  renderCategories();renderSubcategories();renderItems();
};
document.getElementById('cart-btn').onclick=()=>{
Â  navButtonActivate('cart-btn');
Â  showAppSection('cart');
Â  openCartModal();
};
document.getElementById('profile-btn').onclick=()=>{
Â  navButtonActivate('profile-btn');
Â  showAppSection('profile');
Â  openProfileModal();
};
document.getElementById('toggle-theme-btn').onclick=()=>{
Â  const th=document.documentElement.getAttribute('data-theme');
Â  document.documentElement.setAttribute('data-theme',th==='dark'?'light':'dark');
Â  localStorage.setItem(themeKey,th==='dark'?'light':'dark');
};


// ----------- CATEGORY UI ---------
function renderCategories(){
Â  categoryPanel.innerHTML='';
Â  categories.forEach(cat=>{
Â  Â  const b=document.createElement('button');
Â  Â  b.textContent=cat.name;
Â  Â  b.className='category-btn'+(cat.name===currentCategory?' active':'');
Â  Â  b.onclick=()=>{
Â  Â  Â  currentCategory=cat.name;currentSubcategory='';renderCategories();renderSubcategories();renderItems();
Â  Â  };
Â  Â  categoryPanel.appendChild(b);
Â  });
}
function renderSubcategories(){
Â  subcategoryPanel.innerHTML='';
Â  if(currentCategory==='All')return;
Â  let subs=categories.find(c=>c.name===currentCategory)?.subs||[];
Â  subs.forEach(sub=>{
Â  Â  const b=document.createElement('button');
Â  Â  b.textContent=sub;b.className='subcategory-btn'+(sub===currentSubcategory?' active':'');
Â  Â  b.onclick=()=>{currentSubcategory=sub;renderSubcategories();renderItems();};
Â  Â  subcategoryPanel.appendChild(b);
Â  });
}


// ------- FILTER BAR -------
priceRangeInput.oninput=()=>{
Â  maxPriceFilter=+priceRangeInput.value;
Â  priceValueDisplay.textContent='â‚¹'+maxPriceFilter.toLocaleString();
Â  renderItems();
};
ratingFilterButtons.forEach(btn=>{
Â  btn.onclick=()=>{
Â  Â  const rating=+btn.getAttribute('data-rating'),on=btn.classList.contains('active');
Â  Â  if(on){btn.classList.remove('active');ratingFilters.delete(rating);}
Â  Â  else{btn.classList.add('active');ratingFilters.add(rating);}
Â  Â  renderItems();
Â  };
});


// ----------- SEARCH -----------
searchInput.oninput=e=>{
Â  currentSearchTerm=e.target.value.trim().toLowerCase();
Â  renderItems();
};
clearSearchHistoryBtn.onclick=()=>{
Â  searchInput.value='';currentSearchTerm='';renderItems();
};
// ---------- MAIN/PRODUCTS RENDER ----------
function filterItems(){
Â  let filtered=items;
Â  if(currentCategory!=='All')filtered=filtered.filter(i=>i.category===currentCategory);
Â  if(currentSubcategory)filtered=filtered.filter(i=>i.subcategory===currentSubcategory);
Â  if(currentSearchTerm)filtered=filtered.filter(i=>
Â  Â  i.name.toLowerCase().includes(currentSearchTerm)||i.description.toLowerCase().includes(currentSearchTerm)
Â  );
Â  filtered=filtered.filter(i=>i.price<=maxPriceFilter);
Â  if(ratingFilters.size)filtered=filtered.filter(i=>ratingFilters.has(i.rating));
Â  return filtered;
}
function renderStars(rating){
Â  let s='';
Â  for(let i=1;i<=5;i++)s+=(i<=rating)?'â­':'â˜†';
Â  return `<span class="stars">${s}</span>`;
}
function renderItems(){
Â  itemsList.innerHTML='';
Â  if(!itemsPanel) return;
Â  if(typeof items=="undefined"||!Array.isArray(items))return;
Â  const filtered=filterItems();
Â  if(filtered.length===0){
Â  Â  itemsList.innerHTML='<p style="color:var(--secondary);font-weight:700;">No items found.</p>';return;
Â  }
Â  filtered.forEach(item=>{
Â  Â  const c=document.createElement('div');
Â  Â  c.className='item-card';
Â  Â  c.innerHTML=`
Â  Â  Â  <img src="${item.imageUrl}" alt="${item.name}" class="item-image"/>
Â  Â  Â  <div class="item-details">
Â  Â  Â  Â  <div class="item-name">${item.name}</div>
Â  Â  Â  Â  <div class="item-description">${item.description}</div>
Â  Â  Â  Â  <div class="item-price">â‚¹${item.price.toLocaleString()}</div>
Â  Â  Â  Â  <div class="item-rating">${renderStars(item.rating)}</div>
Â  Â  Â  Â  <div class="item-action">
Â  Â  Â  Â  Â  <button class="add-cart-btn${cart.some(ci=>ci.id===item.id)?' added':''}">${cart.some(ci=>ci.id===item.id)?'âœ… Added':'Add to Cart'}</button>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  `;
Â  Â  c.querySelector('.add-cart-btn').onclick=()=>{
Â  Â  Â  if(!cart.some(ci=>ci.id===item.id)){
Â  Â  Â  Â  cart.push({...item,quantity:1});
Â  Â  Â  Â  renderItems();
Â  Â  Â  }
Â  Â  };
Â  Â  itemsList.appendChild(c);
Â  });
}



// -------- CART MODAL --------
function openCartModal(){
Â  let total=cart.reduce((a,b)=>a+b.price*b.quantity,0);
Â  let html='';
Â  if(cart.length===0){
Â  Â  html="<p style='text-align:center;'>Your cart is empty.</p>";
Â  } else {
Â  Â  html=`<table class="cart-table">
Â  Â  Â  <thead><tr>
Â  Â  Â  <th>Product</th><th>Qty</th><th>Price</th><th>Subtotal</th><th></th>
Â  Â  Â  </tr></thead><tbody>`;
Â  Â  cart.forEach((ci,i)=>{
Â  Â  Â  html+=`<tr>
Â  Â  Â  <td>${ci.name}</td>
Â  Â  Â  <td>
Â  Â  Â  Â  <button class="cart-decbtn" onclick="window.changeCartQty(${i},-1)">âˆ’</button>
Â  Â  Â  Â  <span>${ci.quantity}</span>
Â  Â  Â  Â  <button class="cart-incbtn" onclick="window.changeCartQty(${i},1)">+</button>
Â  Â  Â  </td>
Â  Â  Â  <td>â‚¹${ci.price.toLocaleString()}</td>
Â  Â  Â  <td>â‚¹${(ci.price*ci.quantity).toLocaleString()}</td>
Â  Â  Â  <td><button class="cart-removebtn" onclick="window.removeFromCart(${i})" title="Remove">ğŸ—‘</button></td>
Â  Â  Â  </tr>`;
Â  Â  });
Â  Â  html+=`</tbody></table>
Â  Â  Â  <div style="padding:7px 0 0 0;text-align:right;font-weight:bold;color:var(--primary);">
Â  Â  Â  Â  Total: â‚¹${total.toLocaleString()}
Â  Â  Â  </div>
Â  Â  Â  <div style="text-align:center;margin-top:12px;">
Â  Â  Â  Â  <button onclick="window.confirmOrder()" class="confirm-order-btn">Confirm Order</button>
Â  Â  Â  Â  <button onclick="window.clearCart()" class="clear-cart-btn">Clear Cart</button>
Â  Â  Â  </div>
Â  Â  `;
Â  }
Â  openModal(html,'Your Cart');
}
window.changeCartQty=function(idx,delta){
Â  let ci=cart[idx];
Â  ci.quantity+=delta;if(ci.quantity<1)ci.quantity=1;
Â  renderItems();openCartModal();
};
window.removeFromCart=function(idx){
Â  cart.splice(idx,1);
Â  renderItems();openCartModal();
};
window.clearCart=function(){
Â  if(confirm("Clear entire cart?")){ cart.length=0;renderItems();openCartModal();}
};
window.confirmOrder=function(){
Â  if(cart.length==0){alert("Cart empty!");return;}
Â  let summary=cart.map(ci=>`${ci.quantity} x ${ci.name} (â‚¹${ci.price})`).join(", ");
Â  orderHistory.push({items:cart.map(x=>({...x})), time:(new Date()).toLocaleString(),summary});
Â  cart.length=0;renderItems();
Â  alert("Order confirmed!\n"+summary);
Â  closeModal();
};


// -------------- PROFILE MODAL --------------
function openProfileModal(){
Â  let html="";
Â  if(!loggedInUser) {html="<p>No data</p>";}
Â  else {
Â  Â  html+=`<div class='profile-detail-box'><label>Name:</label> ${loggedInUser.fullname}<br>
Â  Â  Â  <label>Email:</label> ${loggedInUser.email}<br>
Â  Â  Â  <label>Phone:</label> ${loggedInUser.phone}<br>
Â  Â  Â  <label>Location:</label> ${loggedInUser.location}<br>
Â  Â  Â  <label>Login at:</label> ${loggedInUser.loginTime||''}<br>
Â  Â  Â  </div>
Â  Â  Â  <button class="edit-profile-btn" id="edit-profile-btn">Edit Profile</button>
Â  Â  Â  <hr>
Â  Â  Â  <button onclick="window.showChangePwd()" class="reset-btn">Change Password</button>
Â  Â  Â  <hr>
Â  Â  Â  <div>
Â  Â  Â  <label>Order History:</label>
Â  Â  Â  <ol class="order-list" id="order-list">
Â  Â  Â  Â  ${orderHistory.length==0?"<li>No previous orders.</li>":
Â  Â  Â  Â  Â  orderHistory.map((o,i)=>`<li>${o.time}<br><div style='font-size:90%;color:var(--primary);'>${o.summary}</div></li>`).join("\n")
Â  Â  Â  Â  }
Â  Â  Â  </ol>
Â  Â  Â  <button onclick="window.clearOrderHistory()" class="reset-btn" style="background:linear-gradient(100deg,#fa5252,#41e77b);color:#fff;">Clear Order History</button>
Â  Â  Â  </div>
Â  Â  Â  `;
Â  }
Â  openModal(html,"Profile");

Â  // Add listener for edit profile button after modal opens
Â  setTimeout(()=>{
Â  Â  const editBtn=document.getElementById('edit-profile-btn');
Â  Â  if(editBtn){
Â  Â  Â  editBtn.onclick=showEditProfileForm;
Â  Â  }
Â  },100);
}

// Show edit profile form in the modal
function showEditProfileForm(){
Â  if(!loggedInUser) return;
Â  const html=`
Â  Â  <form id="edit-profile-form" autocomplete="off">
Â  Â  Â  <label for="edit-fullname">Full Name</label>
Â  Â  Â  <input id="edit-fullname" type="text" required value="${loggedInUser.fullname}" placeholder="Full Name (min 2 words)">
Â  Â  Â  <label for="edit-phone">Phone</label>
Â  Â  Â  <input id="edit-phone" type="text" maxlength="10" pattern="^\\d{10}$" required value="${loggedInUser.phone}" placeholder="10 digit number" />
Â  Â  Â  <label for="edit-email">Email</label>
Â  Â  Â  <input id="edit-email" type="email" required value="${loggedInUser.email}" placeholder="your@email.com">
Â  Â  Â  <label for="edit-location">Location</label>
Â  Â  Â  <input id="edit-location" type="text" placeholder="Location" value="${loggedInUser.location}">
Â  Â  Â  <button type="submit" class="edit-profile-btn">Save Changes</button>
Â  Â  </form>
Â  `;
Â  modalContent.innerHTML=`
Â  Â  <button class="close-modal-btn" onclick="document.getElementById('modal-overlay').style.display='none'">&times;</button>
Â  Â  <div class="modal-header">Edit Profile</div>` + html;

Â  const form=document.getElementById('edit-profile-form');
Â  form.onsubmit=e=>{
Â  Â  e.preventDefault();
Â  Â  // Validate
Â  Â  const nm=form['edit-fullname'].value.trim();
Â  Â  const ph=form['edit-phone'].value.trim();
Â  Â  const em=form['edit-email'].value.trim();
Â  Â  const loc=form['edit-location'].value.trim();
Â  Â  if(nm.split(/\s+/).length<2){
Â  Â  Â  alert("Please enter at least 2 words for Full Name.");
Â  Â  Â  return;
Â  Â  }
Â  Â  if(!/^\d{10}$/.test(ph)){
Â  Â  Â  alert("Please enter valid 10 digit phone number.");
Â  Â  Â  return;
Â  Â  }
Â  Â  if(!/^[\w.-]+@[\w.-]+\.[a-zA-Z]{2,}$/.test(em)){
Â  Â  Â  alert("Please enter valid email.");
Â  Â  Â  return;
Â  Â  }
Â  Â  // Save changes to loggedInUser
Â  Â  loggedInUser.fullname=nm;
Â  Â  loggedInUser.phone=ph;
Â  Â  loggedInUser.email=em;
Â  Â  loggedInUser.location=loc||'Not set';
Â  Â  alert("Profile updated successfully!");
Â  Â  openProfileModal();
Â  };
}


window.showChangePwd=function(){
Â  let html=`<div style="margin-bottom:1.3em;">
Â  Â  <label>New Password:</label><input type="password" id="new-pwd-inp" style="width:80%;margin:0.5em 1em;">
Â  Â  <br>
Â  Â  <button class="reset-btn" onclick="window.submitPwdChange()">Submit</button>
Â  </div>`;
Â  modalContent.innerHTML+=html;
};
window.submitPwdChange=function(){
Â  let np=document.getElementById('new-pwd-inp');
Â  if(!np.value||np.value.length<6){alert("Min 6 chars");return;}
Â  loggedInUser.password=np.value;alert("Password changed!");
};
window.clearOrderHistory=function(){
Â  if(confirm("Clear all order history?"))orderHistory=[];
Â  openProfileModal();
};



// ---------- INITIALIZE ----------
renderCategories();renderSubcategories();renderItems();applyTheme();


})();
</script>
</body>
</html>
